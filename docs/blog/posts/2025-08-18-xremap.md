---
title: "Dvorak Everywhere on Arch + Hyprland with xremap"
date: 2025-08-13
categories: [linux, input, hyprland]
tags: [xremap, dvorak, wayland, arch]
summary: "Karabiner-style remapping using xremap; works across Wayland/Hyprland, VMs, RDP, and TTY."
---

## Overview

This guide shows how to get **Dvorak** everywhere on **Arch Linux** with **Hyprland** using **xremap**—a Karabiner-like remapper that works at the input layer. You'll install xremap, grant `uinput` access, add a Dvorak config, test it, and enable it to autostart for **all keyboards** (internal + external).

> If you've experimented with other remappers (keyd, interception-tools) and want a clean slate first, remove their services/configs before proceeding.
<!-- more -->

---

## Prerequisites

- Arch Linux (or Arch-based)
- Hyprland (Wayland)
- A terminal with sudo privileges

---

## 1) Install xremap

**Option A — AUR (Hyprland build, recommended):**

```bash
yay -S xremap-hypr-bin
```

**Option B — Build from cargo (with Hyprland support):**

```bash
# Install Rust toolchain if needed:
# sudo pacman -S rustup && rustup default stable

cargo install xremap --features hypr
# xremap binary will normally be in ~/.cargo/bin/xremap
```

---

## 2) One-time permissions for non-root use

These steps allow your normal user to run xremap by giving access to `/dev/uinput` and the `input` group. If you prefer running `sudo xremap ...`, you can skip this section.

```bash
# Load uinput now + at boot
sudo modprobe uinput
echo uinput | sudo tee /etc/modules-load.d/uinput.conf >/dev/null

# Allow users in 'input' group to open /dev/uinput
echo 'KERNEL=="uinput", GROUP="input", TAG+="uaccess"' | sudo tee /etc/udev/rules.d/99-input.rules >/dev/null

# Add yourself to the input group
sudo gpasswd -a "$USER" input

# Apply rules now
sudo udevadm control --reload-rules && sudo udevadm trigger

# IMPORTANT: Log out and back in (or reboot) so the new group applies to your session.
```

---

## 3) Create the Dvorak config

Create `~/.config/xremap/config.yml` with this QWERTY → Dvorak map:

```yaml
modmap:
  - name: QWERTY→Dvorak (US)
    remap:
      # number row adjustments
      minus: leftbrace
      equal: rightbrace

      # top row
      q: apostrophe
      w: comma
      e: dot
      r: p
      t: y
      y: f
      u: g
      i: c
      o: r
      p: l
      leftbrace: slash
      rightbrace: equal

      # home row
      a: a
      s: o
      d: e
      f: u
      g: i
      h: d
      j: h
      k: t
      l: n
      semicolon: s
      apostrophe: minus

      # bottom row
      z: semicolon
      x: q
      c: j
      v: k
      b: x
      n: b
      m: m
      comma: w
      dot: v
      slash: z
```

> This maps **keys**, not characters, so shifted symbols work correctly (e.g., `"` from Shift+apostrophe).

---

## 4) Quick test (no changes to your system yet)

Run xremap in the foreground and apply to **all keyboards**:

```bash
xremap ~/.config/xremap/config.yml --watch
# If you skipped the uinput permissions, run with sudo instead:
# sudo xremap ~/.config/xremap/config.yml --watch
```

Type in any text box:
- Press **Q** → you should get **'**.
- Press **W** → you should get **,**.

Stop with `Ctrl+C` to exit the test.

> If xremap reports “No device was selected!”, either run with `sudo` or specify a device:
> ```bash
> sudo libinput list-devices | awk '/Keyboard/{p=1} p; /^$/{p=0}'
> xremap ~/.config/xremap/config.yml --device "Asus Keyboard" --watch
> # or by event node:
> xremap ~/.config/xremap/config.yml --device /dev/input/event5 --watch
> ```

---

## 5) Autostart for **all keyboards** (systemd user service)

Create a user service so xremap launches automatically at login and remaps **every** keyboard you connect:

```bash
mkdir -p ~/.config/systemd/user

cat > ~/.config/systemd/user/xremap.service <<'EOF'
[Unit]
Description=Xremap Dvorak Remap (all keyboards)
After=graphical-session.target

[Service]
Type=simple
# No --device flags -> xremap will grab all keyboards it can
ExecStart=/usr/bin/xremap %h/.config/xremap/config.yml --watch
Restart=on-failure

[Install]
WantedBy=default.target
EOF

systemctl --user daemon-reload
systemctl --user enable --now xremap.service
```

Verify:
```bash
systemctl --user status xremap
```

Reboot and confirm Dvorak works on both the internal and any external keyboards.

---

## 6) (Optional) Limit to specific keyboards

If a non-keyboard gadget gets remapped, restrict xremap to named devices:

```ini
# Edit the service ExecStart line like this:
ExecStart=/usr/bin/xremap %h/.config/xremap/config.yml --device "Asus Keyboard" --device "Logitech USB Keyboard" --watch
```

Find names with:
```bash
sudo libinput list-devices | grep -A3 Keyboard
```

Restart the user service after changes:
```bash
systemctl --user restart xremap
```

---

## 7) Troubleshooting

- **“No device was selected!”**  
  Run with `sudo` or add `--device "Your Keyboard"`; ensure `uinput` is loaded and your user is in the `input` group.

- **Wayland/Hyprland backend issues**  
  Ensure you installed the Hyprland-capable build (`xremap-hypr-bin` from AUR) or `cargo install xremap --features hypr`.

- **Nothing changes when typing**  
  Double-check the config path, and confirm the service is running:  
  `journalctl --user -u xremap -b --no-pager | tail -n 100`

- **Conflicts with other remappers**  
  Remove/disable any `keyd`, `interception-tools`, or DE/WM layout settings; let xremap do the mapping. In Hyprland, set `kb_layout = us` and no `kb_variant`.

---

## 8) Uninstall / rollback

```bash
# stop autostart
systemctl --user disable --now xremap.service
rm -f ~/.config/systemd/user/xremap.service

# remove config
rm -rf ~/.config/xremap

# remove package
# yay -Rns xremap-hypr-bin     # if installed from AUR
# or
# cargo uninstall xremap       # if installed via cargo

# optional: revert uinput rule/group
sudo rm -f /etc/udev/rules.d/99-input.rules /etc/modules-load.d/uinput.conf
sudo gpasswd -d "$USER" input
sudo udevadm control --reload-rules && sudo udevadm trigger
```

---

## Notes

- This approach remaps at the input layer, so it works in **TTY**, **Wayland**, and inside **VM/RDP** sessions because the remap happens before the app/desktop sees the keys.
- If you prefer a temporary toggle to QWERTY, you can maintain a second config and switch services, or add more advanced rules in xremap (layers, per-app maps).
